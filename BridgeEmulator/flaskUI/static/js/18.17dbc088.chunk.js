(this.webpackJsonpdiyhue=this.webpackJsonpdiyhue||[]).push([[18],{201:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return I}));var c=a(36),n=a(2),i=a(60),s=a.n(i),o=a(190),r=a(170),l=a(31),d=a(188),u=a(88),j=a(176),h=a.n(j);function p(e,t,a){void 0===a&&(a=254);var c=1-e-t,n=(a/254).toFixed(2),i=n/t*e,s=n/t*c,o=1.656492*i-.354851*n-.255038*s,r=.707196*-i+1.655397*n+.036152*s,l=.051713*i-.121364*n+1.01153*s;return o>l&&o>r&&o>1?(r/=o,l/=o,o=1):r>l&&r>o&&r>1?(o/=r,l/=r,r=1):l>o&&l>r&&l>1&&(o/=l,r/=l,l=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,r=r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055,l=l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055,o=Math.round(255*o),r=Math.round(255*r),l=Math.round(255*l),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(l)&&(l=0),"rgba("+Math.floor(o)+","+Math.floor(r)+","+Math.floor(l)+",1)"}function b(e){var t,a,c,n=2e4/e;return n<=66?(t=255,a=99.4708025861*Math.log(n)-161.1195681661,c=n<=19?0:138.5177312231*Math.log(n-10)-305.0447927307):(t=329.698727446*Math.pow(n-60,-.1332047592),a=288.1221695283*Math.pow(n-60,-.0755148492),c=255),t=t>255?255:t,a=a>255?255:a,c=c>255?255:c,"rgba("+Math.floor(t)+","+Math.floor(a)+","+Math.floor(c)+",1)"}function O(e,t,a){var c=.664511*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.154324*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.162028*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92),n=.283881*e+.668433*t+.047685*a,i=88e-6*e+.07231*t+.986039*a,s=(c/(c+n+i)).toFixed(4),o=(n/(c+n+i)).toFixed(4);return isNaN(s)&&(s=0),isNaN(o)&&(o=0),[parseFloat(s),parseFloat(o)]}var x=a.p+"static/media/nightsky.a7e58287.jpg",f=a(7),g=function(e){var t=e.HOST_IP,a=e.api_key,n=e.groupId,i=e.scenes,o=e.sceneModal,r=e.setSceneModal;function d(){r(!1)}return Object(f.jsxs)(h.a,{isOpen:o,onAfterOpen:function(){},onRequestClose:d,contentLabel:"Example Modal",children:[Object(f.jsxs)("div",{className:"header",children:[Object(f.jsx)("div",{className:"headline",children:"Scene Picker"}),Object(f.jsx)("div",{className:"iconbox",children:Object(f.jsx)("button",{onClick:d,children:Object(f.jsx)(l.p,{})})})]}),Object(f.jsx)("div",{className:"scenecontainer",children:Object.entries(i).filter((function(e){return e[1].group===n})).map((function(e){var n=Object(c.a)(e,2),i=n[0],o=n[1];return Object(f.jsxs)("div",{className:"scene",style:{background:"url(".concat(x,")"),backgroundSize:"cover"},onClick:function(){return function(e){s.a.put("".concat(t,"/api/").concat(a,"/groups/0/action"),{scene:e})}(i)},children:[Object(f.jsxs)("div",{className:"dimmer",children:[Object.entries(o.lightstates).filter((function(e,t){return t<5})).map((function(e){var n,i=Object(c.a)(e,2),o=i[0],r=i[1];return Object(f.jsx)("div",{className:"color",style:{background:"".concat((n=r,"xy"in n?p(n.xy[0],n.xy[1],254):"ct"in n?b(n.ct):"rgba(200,200,200,1)"))},onClick:function(){return function(e,c){s.a.put("".concat(t,"/api/").concat(a,"/lights/").concat(e,"/state"),c)}(o,r)}},o)})),Object(f.jsx)("div",{className:"name",children:o.name})]}),Object(f.jsx)("div",{className:"dynamiccontrol",children:Object(f.jsx)("i",{className:"far fa-play-circle"})})]},i)}))})]})},v=a(186),m=function(e){var t=e.HOST_IP,a=e.api_key,c=e.id,n=e.light,i=function(e){console.log("Apply state "+JSON.stringify(e)),s.a.put("".concat(t,"/api/").concat(a,"/lights/").concat(c,"/state"),e)};return Object(f.jsxs)("div",{className:"groupCard light",children:[Object(f.jsxs)("div",{className:"row top",children:[Object(f.jsx)("div",{className:"gradient",style:function(){if(n.state.on)return{background:"xy"===n.state.colormode?p(n.state.xy[0],n.state.xy[1],254):"ct"===n.state.colormode?b(n.state.ct):"linear-gradient(90deg, rgba(255,212,93,1))"}}(),children:Object(f.jsx)(l.j,{})}),Object(f.jsx)("div",{className:"text",children:Object(f.jsxs)("p",{className:"name",children:[n.name," ",n.state.reachable||Object(f.jsx)(v.a,{title:"Unrechable"})]})}),Object(f.jsx)("div",{className:"switchContainer",children:Object(f.jsxs)("label",{className:"switch",children:[Object(f.jsx)("input",{type:"checkbox",defaultChecked:n.state.on,onChange:function(e){return i({on:e.currentTarget.checked})}}),Object(f.jsx)("span",{className:"slider"})]})})]}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"sliderContainer",children:Object(f.jsx)("input",{type:"range",min:"1",max:"254",defaultValue:n.state.bri,className:"slider",onChange:function(e){return i({bri:parseInt(e.currentTarget.value)})}})})})]})},y=a(174);function N(e){var t=e.HOST_IP,a=e.api_key,c=e.lights,i=e.groupLights,o=Object(n.useRef)(null),l=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e,n=[],d=Object(r.a)(i.entries());try{for(d.s();!(e=d.n()).done;){var u=e.value;u=u[1],"xy"in c[u].state&&n.push(p(c[u].state.xy[0],c[u].state.xy[1],254))}}catch(j){d.e(j)}finally{d.f()}o.current&&!l.current&&(l.current=new y.a.ColorPicker(o.current,{layout:[{component:y.a.ui.Wheel,options:{}}],colors:n}),l.current.on("input:end",(function(e){var c=e.rgb;s.a.put("".concat(t,"/api/").concat(a,"/lights/").concat(i[e.index],"/state"),{xy:O(c.r,c.g,c.b)})})))}),[i,c,t,a]),Object(f.jsx)("div",{ref:o})}function k(e){var t=e.HOST_IP,a=e.api_key,c=e.group,i=e.groupId,o=Object(n.useRef)(null),r=Object(n.useRef)(null);return Object(n.useEffect)((function(){o.current&&!r.current&&(r.current=new y.a.ColorPicker(o.current,{layoutDirection:"horizontal",layout:[{component:y.a.ui.Slider,options:{sliderType:"kelvin",sliderShape:"circle"}}],color:b(c.action.ct)}),r.current.on("input:end",(function(e){var c=e.kelvin,n=Math.floor((11e3-c)/25.5+153);s.a.put("".concat(t,"/api/").concat(a,"/groups/").concat(i,"/action"),{ct:n})})))}),[c,i,t,a]),Object(f.jsx)("div",{ref:o})}var w=a(187),_=a.n(w),M=a(162),C=a(161),S=a(202),T=a(175),P=function(e){var t=e.HOST_IP,a=e.api_key,i=e.id,j=e.group,h=e.lights,O=e.scenes,x=Object(n.useState)("closed"),v=Object(c.a)(x,2),y=v[0],w=v[1],P=Object(n.useState)(!1),I=Object(c.a)(P,2),H=I[0],E=I[1],A=Object(n.useState)([]),F=Object(c.a)(A,2),R=F[0],J=F[1],L={opened:{opacity:1},closed:{opacity:0}};!function(){var e,t=Object(r.a)(j.lights);try{for(t.s();!(e=t.n()).done;){var a=e.value;"xy"in h[a].state&&!R.includes("xy")&&J([].concat(Object(o.a)(R),["xy"])),"ct"in h[a].state&&!R.includes("ct")&&J([].concat(Object(o.a)(R),["ct"]))}}catch(c){t.e(c)}finally{t.f()}}();var V=Object(n.useCallback)(_()((function(e){j.action.bri=e;var c={bri:e};s.a.put("".concat(t,"/api/").concat(a,"/groups/").concat(i,"/action"),c)}),300),[]);return Object(f.jsxs)("div",{className:"groupCard",children:[Object(f.jsx)(g,{HOST_IP:t,api_key:a,groupId:i,scenes:O,sceneModal:H,setSceneModal:E}),Object(f.jsxs)("div",{className:"row top",children:[Object(f.jsx)("div",{className:"gradient",style:function(){if(j.state.any_on){var e,t="linear-gradient(45deg, ",a=100/j.lights.length,n=Object(r.a)(j.lights.entries());try{for(n.s();!(e=n.n()).done;){var i=Object(c.a)(e.value,2),s=i[0],o=i[1];"xy"===h[o].state.colormode?(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+p(h[o].state.xy[0],h[o].state.xy[1],254)+" "+Math.floor(a*(s+1))+"%,"):"ct"===h[o].state.colormode?(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+b(h[o].state.ct)+" "+Math.floor(a*(s+1))+"%,"):(1===j.lights.length&&(t+="rgba(200,200,200,1) 0%,"),t=t+"rgba(255,212,93,1) "+Math.floor(a*(s+1))+"%,")}}catch(l){n.e(l)}finally{n.f()}return{background:t.slice(0,-1)+")"}}}(),children:"Zone"===j.type?Object(f.jsx)(d.a,{style:{fill:j.state.any_on?"#3a3a3a":"#ddd"}}):Object(f.jsx)(T.a,{type:"room-"+j.class,color:j.state.any_on?"#3a3a3a":"#ddd"})}),Object(f.jsxs)("div",{className:"text",children:[Object(f.jsxs)("p",{className:"name",children:[" ",j.name," "]}),Object(f.jsx)("p",{className:"subtext",children:function(){var e,t=0,a=0,c=Object(r.a)(j.lights);try{for(c.s();!(e=c.n()).done;){var n=e.value;!0===h[n].state.on?t+=1:a+=1}}catch(i){c.e(i)}finally{c.f()}return 0===t?"All lights off":0===a?"All lights on":t+" lights on"}()})]}),Object(f.jsx)("div",{className:"switchContainer",children:Object(f.jsxs)("label",{className:"switch",children:[Object(f.jsx)("input",{type:"checkbox",defaultValue:j.state.any_on,defaultChecked:j.state.any_on,onChange:function(e){return function(e){var c={on:e};j.state.any_on=e,e||w("closed"),s.a.put("".concat(t,"/api/").concat(a,"/groups/").concat(i,"/action"),c)}(e.target.checked)}}),Object(f.jsx)("span",{className:"slider",children:" "})]})})]}),Object(f.jsx)("div",{className:"row background",children:Object(f.jsx)(M.a,{initial:!1,children:j.state.any_on&&Object(f.jsx)(C.a.div,{className:"sliderContainer",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:Object(f.jsx)("input",{type:"range",min:"1",max:"254",defaultValue:j.action.bri,step:"1",className:"slider",onChange:function(e){return V(parseInt(e.target.value))}})})})}),Object(f.jsxs)(S.a,{children:["closed"!==y&&Object(f.jsxs)(C.a.div,{className:"row buttons",initial:"closed",animate:"closed"===y?"closed":"opened",variants:L,children:[Object(f.jsx)(C.a.div,{className:"btn ".concat(R.includes("xy")?"":"disabled"),whileHover:{scale:1.2},whileTap:{scale:.9},variants:L,children:Object(f.jsx)(l.m,{onClick:!!R.includes("xy")&&function(){return w("colorPicker")}})}),Object(f.jsx)(C.a.div,{className:"btn ".concat(R.includes("ct")?"":"disabled"),whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(u.b,{onClick:!!R.includes("ct")&&function(){return w("colorTempPicker")}})}),Object(f.jsx)(C.a.div,{className:"btn",whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(l.h,{onClick:function(){return E(!0)}})}),Object(f.jsx)(C.a.div,{className:"btn",whileHover:{scale:1.2},whileTap:{scale:.9},children:Object(f.jsx)(l.j,{onClick:function(){return w("lights")}})})]}),Object(f.jsx)(C.a.div,{className:"row colorpicker",children:Object(f.jsxs)(M.a,{initial:!1,exitBeforeEnter:!0,children:["colorPicker"===y&&Object(f.jsx)(C.a.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,scale:1,height:"auto"},collapsed:{opacity:0,scale:.5,height:0}},transition:{duration:.3},children:Object(f.jsx)(N,{HOST_IP:t,api_key:a,lights:h,groupLights:j.lights})},"content"),"colorTempPicker"===y&&Object(f.jsx)(C.a.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto",scale:1},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:Object(f.jsx)(k,{HOST_IP:t,api_key:a,groupId:i,group:j})},"content"),"lights"===y&&Object(f.jsx)(C.a.div,{className:"lights",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.3},children:j.lights.map((function(e){return Object(f.jsx)(m,{HOST_IP:t,api_key:a,id:e,light:h[e]},e)}))})]})})]}),Object(f.jsx)(M.a,{children:Object(f.jsx)("div",{className:"row bottom",children:Object(f.jsx)(C.a.div,{className:"expandbtn",initial:"collapsed",animate:"closed"===y?"collapsed":"open",whileHover:{scale:1.2},whileTap:{scale:.9},variants:{open:{rotate:180},collapsed:{rotate:0}},transition:{duration:.3},children:Object(f.jsx)(l.b,{onClick:function(){"closed"===y?R.includes("xy")?w("colorPicker"):R.includes("ct")?w("colorTempPicker"):w("lights"):w("closed")}})})})})]})};function I(e){var t=e.HOST_IP,a=e.API_KEY,i=Object(n.useState)({config:{},lights:{},groups:{},scenes:{}}),o=Object(c.a)(i,2),r=o[0],l=o[1];return Object(n.useEffect)((function(){var e=function(){void 0!==a&&s.a.get("".concat(t,"/api/").concat(a)).then((function(e){l(e.data)})).catch((function(e){console.error(e)}))};e();var c=setInterval((function(){e()}),2e3);return function(){return clearInterval(c)}}),[t,a]),Object(f.jsx)("div",{className:"inner",children:Object(f.jsx)("div",{className:"cardGrid",children:Object.entries(r.groups).filter((function(e){return"Entertainment"!==e[1].type})).map((function(e){var n=Object(c.a)(e,2),i=n[0],s=n[1];return Object(f.jsx)(P,{api_key:a,HOST_IP:t,id:i,group:s,lights:r.lights,scenes:r.scenes},i)}))})})}}}]);
//# sourceMappingURL=18.17dbc088.chunk.js.map